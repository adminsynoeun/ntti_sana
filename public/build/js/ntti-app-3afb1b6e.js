import{s as k}from"./ntti-app-f9e6cc89.js";const v=$("#sch_class_spec"),u=$("#sch_level"),f=$("#sch_shift"),h=$("#sch_skill"),S=$("#sch_info_student"),D=$("#btn_search"),m=$(".loader"),T=$("#pagination"),C=$("#pagination_list");$("#btn_print_card");$("#btn_print_card_view");$("#btn_update_view_info_print");var P=$("#txt_up_date_card");let g=1,x=1;k("#txt_due_class","#modal_card_due_date");k("#txt_due_level","#modal_card_create_expire_date");function U(){const o=v.val(),a=u.val(),e=f.val(),d=h.val(),r={dept_code,class_code:o,sch_level:a,sch_shift:e,sch_skill:d};$.ajax({url:"/certificate/level_shift_skill",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){if(t.record_level&&t.record_level.length>0){const _=t.record_level[0].level,i=t.record_level[0].sections_code,s=t.record_level[0].skills_code;u.val(_),f.val(i),h.val(s),u.select2(),f.select2(),h.select2()}else u.val(""),f.val(""),h.val(""),u.select2(),f.select2(),h.select2()},error:function(t,_,i){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})}function j(){const o="",a=u.val(),e=f.val(),d=h.val(),r={dept_code,class_code:o,sch_level:a,sch_shift:e,sch_skill:d};$.ajax({url:"/certificate/level_shift_skill",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){if(t.record_level&&t.record_level.length>0){const _=t.record_level[0].name;v.val(_),v.select2()}else notyf.error("រកមិនឃើញទិន្ន័យនៅក្នុងប្រព័ន្ធ")},error:function(t,_,i){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})}function l(){m.css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1000"}).fadeIn("slow");const o=v.val(),a={dept_code,class_code:o,search:S.val(),page:g,rows_per_page:parseInt($("#pagination .rows_per_page").val()??50)};$.ajax({url:"/certificate/card_view",type:"POST",contentType:"application/json",data:JSON.stringify(a),cache:!0,success:function(e){const d=$("#tbl_stu_card_view");d.empty();let r=e.current_page,t=e.page,_=e.data;const i=document.createDocumentFragment();if(_&&_.length>0)_.map((s,n)=>{let c=s.status_print==1?"#2f99d1":"#ddd",y=s.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${s.stu_photo}`;const w=$("<div>").addClass("col-md-4 g-2 mt-2").append($("<div>").addClass("student-card-view").css("border",`2px solid ${c}`).append($("<img>").attr("src",y).attr("alt","Profile Picture").attr("width","150").attr("height","200").attr("name","btn_update_view_info_print").attr("id","btn_update_view_info_print").attr("data-stu_code",s.code).attr("data-dept_code",s.department_code).attr("data-class_code",s.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_update")).append($("<div>").addClass("card-body student-information").append($("<div>").addClass("name").text(`${s.name_2} ${s.name}`)).append($("<div>").addClass("id").text(s.code)).append($("<div>").addClass("phone").text(s.phone_student)).append($("<div>").addClass("info").text(s.dept)).append($("<div>").addClass("info").html(`${s.class==null?"No Class":s.class}
                                                    <label class="${s.class_remaining} fw-bold" title="Expire Card">${s.remaining}</label>`)).append($("<hr>")).append($("<button>").addClass("btn btn-outline-info btn-sm").attr("type","button").attr("name","btn_print_card_view").attr("id","btn_print_card_view").attr("data-print_card_id",s.id).attr("data-stu_code",s.code).attr("data-dept_code",s.department_code).attr("data-class_code",s.class_code).attr("title","Print").attr("data-toggle","modal").attr("data-target","#modal_card_print_card").css({"margin-right":"5px"}).html('<i class="mdi mdi-printer btn-icon-append"></i>')).append($("<button>").attr("type","button").addClass("btn btn-outline-danger btn-sm").attr("title","Print").attr("name","btn_print_card_set_revision_view").attr("id","btn_print_card_set_revision_view").attr("data-print_card_id",s.id).attr("data-stu_code",s.code).attr("data-dept_code",s.department_code).attr("data-class_code",s.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_print_revisino").append($("<i>").addClass("mdi mdi-plus btn-icon-append")).css("margin-right","5px","display",s.status_print==0||s.status_print==null?"none":"inline-block")).append($("<button>").attr("type","button").addClass("btn btn-outline-success btn-sm").attr("id","btn_card_view").attr("title","View Detail").attr("data-toggle","modal").attr("data-target","#modal_card_view_detail").attr("data-stu_code",s.code).attr("data-dept_code",s.department_code).css({"margin-right":"5px"}).attr("data-class_code",s.class_code).append($("<i>").addClass("mdi mdi-account-search"))).append($("<button>").attr("type","button").addClass("btn btn-outline-primary btn-sm").attr("title","Update").attr("name","btn_update_view_info_print").attr("id","btn_update_view_info_print").attr("data-stu_code",s.code).attr("data-dept_code",s.department_code).attr("data-class_code",s.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_update").css({"margin-right":"5px"}).append($("<i>").addClass("mdi mdi-border-color"))).append($("<button>").attr("type","button").addClass("btn btn-outline-danger btn-sm").attr("title","Disable Active Print").attr("name","btn_diable_view_info_print").attr("id","btn_diable_view_info_print").attr("data-stu_code",s.code).attr("data-dept_code",s.department_code).attr("data-class_code",s.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_disable_active").css({"margin-right":"5px"}).append($("<i>").addClass("mdi mdi-shuffle-disabled")).prop("hidden",s.status_print!==1)).append($("<button>").attr("type","button").addClass("btn btn-outline-secondary btn-rounded btn-icon pull-right").css({width:"30px",height:"30px","margin-right":"5px"}).append($("<label>").addClass("text-primary").text(n+1+(r-1)*t)))));i.appendChild(w[0])});else{const s=$("<div>").addClass("text-center").append($("<label>").addClass("text-center").text("រកមិនឃើញទិន្ន័យនៅក្នុងប្រព័ន្ធ!"));i.appendChild(s[0])}d.append(i),$("#pagination").html(e.links),setTimeout(function(){m.fadeOut()},100)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})}function p(){m.css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1000"}).fadeIn("slow");const o=v.val(),a={dept_code,class_code:o,search:S.val(),page:x,rows_per_page:parseInt($("#pagination_list .rows_per_page").val()??50)};$.ajax({url:"/certificate/card_view_list",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(e){const d=$("#tbl_card_stu_list");d.empty();let r=e.current_page,t=e.page,_=e.data;const i=document.createDocumentFragment();if(_&&_.length>0)$.each(_,function(s,n){const c=$("<tr>");c.append($("<td>").attr("height","40").text(s+1+(r-1)*t)),c.append($("<td>").text(n.code)),c.append($("<td>").text(n.name_2)),c.append($("<td>").text(n.name)),c.append($("<td>").text(n.gender)),c.append($("<td>").text(n.date_of_birth??"No DOB")),c.append($("<td>").text(n.phone_student)),c.append($("<td>").text(n.class==null?"No Class":n.class)),c.append($("<td>").text(n.skill)),c.append($("<td>").text(n.level));const y=$("<div>").addClass("hover-photo").append($("<img>").attr("src",n.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${n.stu_photo}`).attr("alt","John's Photo"));c.append($("<td>").append(y)),c.append($("<td>").addClass("text-center").text(n.count_revision));const w=$("<div>").addClass("badge badge-pill").addClass(n.status_print==1?"badge-success":"badge-danger").text(n.status_print==1?"Already":"No");c.append($("<td>").append(w));const O=$("<div>").addClass("dropdown").append($("<button>").attr({type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",title:"More Options"}).addClass("btn btn-outline-secondary btn-rounded btn-icon").css({width:"35px",height:"35px","margin-right":"5px"}).append($("<i>").addClass("bi bi-three-dots-vertical"))).append($("<ul>").addClass("dropdown-menu").attr("aria-labelledby","dropdownMenuButton").append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",name:"btn_print_card_view",id:"btn_print_card_view","data-print_card_id":n.id,"data-stu_code":n.code,"data-dept_code":n.department_code,"data-class_code":n.class_code,"data-toggle":"modal","data-target":"#modal_card_print_card"}).append($("<i>").addClass("mdi mdi-printer btn-icon-append")," Print"))).append(n.status_print==0||n.status_print==null?"":$("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",name:"btn_print_card_set_revision_view",id:"btn_print_card_set_revision_view","data-print_card_id":n.id,"data-stu_code":n.code,"data-dept_code":n.department_code,"data-class_code":n.class_code,"data-toggle":"modal","data-target":"#modal_card_print_revisino"}).append($("<i>").addClass("mdi mdi-plus btn-icon-append")," Print"))).append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",title:"View Detail",id:"btn_card_view","data-toggle":"modal","data-target":"#modal_card_view_detail","data-stu_code":n.code,"data-dept_code":n.department_code,"data-class_code":n.class_code}).append($("<i>").addClass("mdi mdi-account-search")," View"))).append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",title:"Update",name:"btn_update_view_info_print",id:"btn_update_view_info_print","data-stu_code":n.code,"data-dept_code":n.department_code,"data-class_code":n.class_code,"data-toggle":"modal","data-target":"#modal_card_update"}).append($("<i>").addClass("mdi mdi-border-color")," Update"))).append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",title:"Disable Active Print",name:"btn_diable_view_info_print",id:"btn_diable_view_info_print","data-stu_code":n.code,"data-dept_code":n.department_code,"data-class_code":n.class_code,"data-toggle":"modal","data-target":"#modal_card_disable_active"}).append($("<i>").addClass("mdi mdi-shuffle-disabled")," Disable"))));c.append($("<td>").append(O)),i.appendChild(c[0])});else{const s=$("<div>").addClass("text-center").append($("<label>").addClass("text-center").attr("colspan",4).attr("height",40).text("រកមិនឃើញទិន្ន័យនៅក្នុងប្រព័ន្ធ!"));i.appendChild(s[0])}d.append(i),$("#pagination_list").html(e.links),setTimeout(function(){m.fadeOut()},100)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})}function b(){m.css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1000"}).fadeIn("slow");const o=v.val(),a={dept_code,class_code:o};$.ajax({url:"/certificate/card_total_student",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(e){$("#tt_students").html(Number(e.total_students)),$("#tt_students_f").html(e.total_female),$("#tt_students_m").html(e.total_male),$("#total_status_1").html(e.total_status_1),$("#total_female_status_1").html(e.total_female_status_1),$("#total_male_status_1").html(e.total_male_status_1),setTimeout(function(){m.fadeOut()},100)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})}v.on("change",function(){U(),b(),g=1,l(),x=1,p()});u.on("change",function(){j()});u.attr("disabled",!0);f.on("change",function(){j()});f.attr("disabled",!0);h.on("change",function(){j()});h.attr("disabled",!0);D.on("click",function(){g=1,l(),x=1,p()});T.on("click",".btn_refresh",function(){g=1,$("#pagination .rows_per_page").val(50),l()});T.on("change",".rows_per_page",function(o){o.preventDefault(),g=1,l()});T.on("click",".page-link[data-page]",function(o){o.preventDefault();var a=$(this).data("page");g=a,l()});C.on("click",".btn_refresh",function(){x=1,$("#pagination_list .rows_per_page").val(50),p()});C.on("change",".rows_per_page",function(o){o.preventDefault(),x=1,p()});C.on("click",".page-link[data-page]",function(o){o.preventDefault();var a=$(this).data("page");x=a,p()});$("body").on("click","#btn_print_card_view",function(o){const a=$(this).data("print_card_id"),e=$(this).data("stu_code"),d=$(this).data("dept_code"),r=$(this).data("class_code");$("#hidden_print_card_id").val(a),$("#hidden_stu_code").val(e),$("#hidden_dept_code").val(d),$("#hidden_class_code").val(r)});$("body").on("click","#btn_print_card",function(o){const a={print_card_id:$("#hidden_print_card_id").val(),stu_code:$("#hidden_stu_code").val(),dept_code:$("#hidden_dept_code").val(),class_code:$("#hidden_class_code").val()};$.ajax({url:"/certificate/print_card",type:"POST",contentType:"application/json",data:JSON.stringify(a),async:!0,success:function(e){jQuery(function(d){const r=d("<div>").html(e);d("body").append(r),r.printThis({importCSS:!1,importStyle:!1,removeInline:!0,base:!1,formValues:!0,iframe:!0,debug:!1}),r.remove()})},complete:function(){},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_print_card_set_revision_view",function(o){const a=$(this).data("print_card_id"),e=$(this).data("stu_code"),d=$(this).data("dept_code"),r=$(this).data("class_code");$("#hidden_revision_print_card_id").val(a),$("#hidden_revision_stu_code").val(e),$("#hidden_revision_dept_code").val(d),$("#hidden_revision_class_code").val(r)});$("body").on("click","#btn_print_set_revision",function(o){const a={print_card_id:$("#hidden_revision_print_card_id").val(),stu_code:$("#hidden_revision_stu_code").val(),dept_code:$("#hidden_revision_dept_code").val(),class_code:$("#hidden_revision_class_code").val()};$.ajax({url:"/certificate/print_card_revision",type:"POST",contentType:"application/json",data:JSON.stringify(a),async:!0,success:function(e){},complete:function(){b(),l(),p()},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_update_view_info_print",function(o){const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code");$("#hidden_update_stu_code").val(a),$("#hidden_update_dept_code").val(e),$("#hidden_update_class_code").val(d);const r={stu_code:a,dept_code:e,class_code:d};$.ajax({url:"/certificate/card_view_info",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){$("#txt_up_view_name").html(t.name),$("#txt_up_view_id").html(t.code),$("#txt_up_view_class").html(t.class),$("#txt_up_view_skill").html(t.skill),$("#txt_up_view_level").html(t.level),$("#txt_up_view_shift").html(t.section_type),$("#txt_up_view_expire_card").html(t.print_expire_date);var _=t.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${t.stu_photo}`;$("#txt_photo_student").attr("src",_)},error:function(t,_,i){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_card_view",function(o){const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code");$("#hidden_update_stu_code").val(a),$("#hidden_update_dept_code").val(e),$("#hidden_update_class_code").val(d);const r={stu_code:a,dept_code:e,class_code:d};$.ajax({url:"/certificate/card_view_info",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){$("#txt_view_name").html(t.name),$("#txt_view_id").html(t.code),$("#txt_view_class").html(t.class),$("#txt_view_skill").html(t.skill),$("#txt_view_level").html(t.level),$("#txt_view_shift").html(t.section_type),$("#txt_view_expire_card").html(t.print_expire_date),$("#txt_view_fullname_kh").html(t.name_2),$("#txt_view_fullname_eng").html(t.name),$("#txt_view_dob").html(t.date_of_birth),$("#txt_view_class_1").html(t.class),$("#txt_view_phone").html(t.phone_student),$("#txt_view_skill_1").html(t.skill),$("#txt_view_email").html(t.email),$("#txt_view_gender").html(t.gender),$("#txt_view_addr").html(t.student_address),$("#txt_view_dept").html(t.dept),$("#txt_view_father").html(t.father_name),$("#txt_view_father_phone").html(t.father_phone),$("#txt_view_father_job").html(t.father_occupation),$("#txt_view_mother").html(t.mother_name),$("#txt_view_mother_phone").html(t.mother_phone),$("#txt_view_mother_job").html(t.mother_occupation),$("#txt_guardian_name").html(t.guardian_name),$("#txt_guardian_phone").html(t.guardian_phone),$("#txt_guardian_occupation").html(t.guardian_occupation),$("#txt_guardian_address").html(t.guardian_address);var _=t.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${t.stu_photo}`;$("#txt_view_photo").attr("src",_)},error:function(t,_,i){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_update_info",function(o){let a=new FormData;a.append("stu_code",$("#hidden_update_stu_code").val()),a.append("dept_code",$("#hidden_update_dept_code").val()),a.append("class_code",$("#hidden_update_class_code").val());var e=$("#fileUploadProfileStu")[0].files[0];e?a.append("photo",e):a.append("photo",null),$.ajax({url:"/certificate/upload_student_info",type:"POST",processData:!1,contentType:!1,cache:!0,async:!0,data:a,success:function(d){d.success==!0?($("#fileUploadProfileStu").val(""),l(),p(),notyf.success(d.message)):notyf.error(d.errors.photo[0])},error:function(d,r,t){notyf.error(`Error submitting class code: ${d.error||"Unknown error"}`)}})});$("#fileUploadProfileStu").on("change",function(){const o=this.files[0];if(o){const a=new FileReader;a.onload=function(e){$(".profile-image img").attr("src",e.target.result)},a.readAsDataURL(o)}});$("body").on("click","#btn_diable_view_info_print",function(o){const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code");$("#hidden_disable_stu_code").val(a),$("#hidden_disable_dept_code").val(e),$("#hidden_diable_class_code").val(d)});$("body").on("click","#btn_card_disable_active",function(o){const a={stu_code:$("#hidden_disable_stu_code").val(),dept_code:$("#hidden_disable_dept_code").val(),class_code:$("#hidden_diable_class_code").val()};$.ajax({url:"/certificate/disable_student_info",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(e){e.success==!0?(b(),l(),p(),notyf.success(e.message)):notyf.error(e.message)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})});P.on("change",function(){const o={date:$(this).val()};$.ajax({url:"/certificate/show_change_date_print_card",type:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(a){$("#txt_up_khmer_lunar").val(a.date_lunar),$("#txt_up_date_create").val(`រាជធានីភ្នំពេញ, ${a.date_khmer}`)},error:function(a,e,d){notyf.error(`Error submitting class code: ${a.statusText||"Unknown error"}`)}})});$("#sl_due_expire_date").on("change",function(){const o={date:$(this).val()};$.ajax({url:"/certificate/show_change_date_print_card",type:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(a){$("#txt_due_expire_date").val(a.date_lunar)},error:function(a,e,d){notyf.error(`Error submitting class code: ${a.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_upload_zip_photo",function(o){let a=$("#up_type_option").val(),e=new FormData;var d=$("#zipFile")[0].files[0];if(e.append("type",a),e.append("zipFile",d),e.append("dept_code",dept_code),$("#previewContainer img").each(function(){let r=$(this).attr("src"),t=$(this).attr("data-name");e.append("imageSources[]",r),e.append("fileNames[]",t)}),!a)return notyf.error("សូមជ្រើសរើសប្រភេទ File Upload"),!1;$.ajax({url:"/certificate/upload_zip_photo",type:"POST",processData:!1,contentType:!1,cache:!1,async:!1,data:e,success:function(r){r.status==200?($("#fm_up_card_base_option")[0].reset(),$("#modal_card_upload_zip_photo .btn-close").trigger("click"),notyf.success(r.message),l()):notyf.error(r.message)},error:function(r,t,_){notyf.error(`Error submitting class code: ${r.error||"Unknown error"}`)}})});$("body").on("click","#btn_card_upload_multiple",function(o){let a=[];$("#previewContainer img").each(function(){let d=$(this).attr("src");if(d.startsWith("data:image")){let t=($(this).attr("alt")||"unnamed").split(".").slice(0,-1).join(".");a.push({name:t,src:d})}});const e={images:a};$.ajax({url:"/certificate/upload_multiple_photo",type:"POST",contentType:"application/json",data:JSON.stringify(e),success:function(d){},error:function(d,r,t){notyf.error(`Error submitting class code: ${d.statusText||"Unknown error"}`)}})});$("body").on("change","#up_type_option",function(o){var a=$(this).val();a=="zip"?($("#up_zip").removeAttr("hidden"),$("#up_multiple").attr("hidden",!0)):a=="multiple"&&($("#up_multiple").removeAttr("hidden"),$("#up_zip").attr("hidden",!0))});$("body").on("click","#btn_print_card_pdf",function(o){o.preventDefault();const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code"),r=`/certificate/print_card_pdf?stu_code=${a}&dept_code=${e}&class_code=${d}`;window.open(r,"_blank")});$("#txt_due_date").on("change",function(){const o={date:$(this).val()};$.ajax({url:"/certificate/show_change_date_print_card",type:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(a){$("#txt_due_khmer_lunar").val(a.date_lunar),$("#txt_due_date_create").val(`រាជធានីភ្នំពេញ, ${a.date_khmer}`)},error:function(a,e,d){notyf.error(`Error submitting class code: ${a.statusText||"Unknown error"}`)}})});$("#modal_card_due_date").on("click","#btn_due_date_this_session",function(o){let a=$("#txt_due_khmer_lunar").val(),e=$("#txt_due_date_create").val(),d=$("#txt_due_expire_date").val();const r={session_code:$("#session_code").val(),print_date:$("#txt_due_date").val(),print_khmer_lunar:a,print_date_due:e,print_expire_date:d};let t=!0;if(["#txt_due_khmer_lunar","#txt_due_date_create"].forEach(function(i){let s=$(i);$.trim(s.val())===""?(s.css("border","2px solid red"),t=!1):s.css("border","")}),!t)return!1;$.ajax({url:"/certificate/card_due_date",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(i){i.status==200?(notyf.success(i.message),$("#fm_card_due_date")[0].reset(),$("#modal_card_due_date .btn-close").trigger("click")):notyf.error(i.message)},error:function(i,s,n){notyf.error(`Error submitting class code: ${i.statusText||"Unknown error"}`)}})});$("#modal_card_due_date").on("click","#btn_update_date_this_session",function(o){let a=$("#txt_due_khmer_lunar").val(),e=$("#txt_due_date_create").val(),d=$("#txt_due_expire_date").val();const r={session_code:$("#session_code").val(),print_date:$("#txt_due_date").val(),print_khmer_lunar:a,print_date_due:e,print_expire_date:d};let t=!0;if(["#txt_due_khmer_lunar","#txt_due_date_create"].forEach(function(i){let s=$(i);$.trim(s.val())===""?(s.css("border","2px solid red"),t=!1):s.css("border","")}),!t)return!1;$.ajax({url:"/certificate/card_due_date_update",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(i){i.status==200?(notyf.success(i.message),$("#fm_card_due_date")[0].reset(),$("#modal_card_due_date .btn-close").trigger("click")):notyf.error(i.message)},error:function(i,s,n){notyf.error(`Error submitting class code: ${i.statusText||"Unknown error"}`)}})});$("#modal_card_create_expire_date").on("click","#btn_due_expire_card",function(o){let a=$("#txt_due_level").val(),e=$("#sl_due_expire_date").val(),d=$("#txt_due_expire_date").val();const r={session_code:$("#session_code").val(),level:a,expire_date:e,print_expire_date:d};let t=!0;if(["#txt_due_level","#txt_due_class","#sl_due_expire_date","#txt_due_expire_date"].forEach(function(s){let n=$(s);$.trim(n.val())===""?(n.css("border","2px solid red"),t=!1):n.css("border","")}),["#txt_due_level","#txt_due_class"].forEach(function(s){let n=$(s),c=n.next(".select2-container");$.trim(n.val())===""?(c.find(".select2-selection").css("border","2px solid red"),t=!1):c.find(".select2-selection").css("border","")}),!t)return!1;$.ajax({url:"/certificate/card_due_expire",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(s){s.status==200?(notyf.success(s.message),$("#fm_card_expire_date")[0].reset(),$("#modal_card_create_expire_date .btn-close").trigger("click"),l(),p()):notyf.error(s.message)},error:function(s,n,c){notyf.error(`Error submitting class code: ${s.statusText||"Unknown error"}`)}})});$("#modal_card_create_expire_date").on("click","#btn_due_update_expire_card",function(o){let a=$("#txt_due_level").val(),e=$("#sl_due_expire_date").val(),d=$("#txt_due_expire_date").val();const r={session_code:$("#session_code").val(),level:a,expire_date:e,print_expire_date:d};let t=!0;if(["#txt_due_level","#txt_due_class","#sl_due_expire_date","#txt_due_expire_date"].forEach(function(s){let n=$(s);$.trim(n.val())===""?(n.css("border","2px solid red"),t=!1):n.css("border","")}),["#txt_due_level","#txt_due_class"].forEach(function(s){let n=$(s),c=n.next(".select2-container");$.trim(n.val())===""?(c.find(".select2-selection").css("border","2px solid red"),t=!1):c.find(".select2-selection").css("border","")}),!t)return!1;$.ajax({url:"/certificate/card_due_expire_update",type:"PUT",contentType:"application/json",data:JSON.stringify(r),success:function(s){s.status==200?(notyf.success(s.message),$("#fm_card_expire_date")[0].reset(),$("#modal_card_create_expire_date .btn-close").trigger("click"),l(),p()):notyf.error(s.message)},error:function(s,n,c){notyf.error(`Error submitting class code: ${s.statusText||"Unknown error"}`)}})});$("#modal_card_create_expire_date").on("change","#txt_due_level",function(o){const e={level:$(this).val()};$.ajax({url:"/certificate/card_expire_show_level",type:"POST",contentType:"application/json",data:JSON.stringify(e),beforeSend:function(){$("#txt_due_class").empty()},success:function(d){d.record_level;let r=new Date(d.record_date).toISOString().split("T")[0];$("#sl_due_expire_date").val(r),$("#txt_due_expire_date").val(d.record_exp_year),$.map(d.record_level,function(t){$("#txt_due_class").append(new Option(t.name,t.code,!0,!0))}),$("#txt_due_class").select2(),k("#txt_due_class","#modal_card_create_expire_date")},error:function(d,r,t){notyf.error(`Error submitting class code: ${d.statusText||"Unknown error"}`)}})});b();l();p();
