import{s as T}from"./ntti-app-54b5515e.js";const g=$("#sch_class_spec"),h=$("#sch_level"),v=$("#sch_shift"),x=$("#sch_skill"),O=$("#sch_info_student");$("#btn_search");const m=$(".loader"),C=$("#pagination"),S=$("#pagination_list");$("#btn_print_card");$("#btn_print_card_view");$("#btn_update_view_info_print");var P=$("#txt_up_date_card");let b=1,y=1;T("#txt_due_class","#modal_card_due_date");T("#txt_due_level","#modal_card_create_expire_date");function U(){const o=g.val(),a=h.val(),e=v.val(),d=x.val(),r={dept_code,class_code:o,sch_level:a,sch_shift:e,sch_skill:d};$.ajax({url:"/certificate/level_shift_skill",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){if(t.record_level&&t.record_level.length>0){const l=t.record_level[0].level,c=t.record_level[0].sections_code,n=t.record_level[0].skills_code;h.val(l),v.val(c),x.val(n),h.select2(),v.select2(),x.select2()}else h.val(""),v.val(""),x.val(""),h.select2(),v.select2(),x.select2()},error:function(t,l,c){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})}function j(){const o="",a=h.val(),e=v.val(),d=x.val(),r={dept_code,class_code:o,sch_level:a,sch_shift:e,sch_skill:d};$.ajax({url:"/certificate/level_shift_skill",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){if(t.record_level&&t.record_level.length>0){const l=t.record_level[0].name;g.val(l),g.select2()}else notyf.error("រកមិនឃើញទិន្ន័យនៅក្នុងប្រព័ន្ធ")},error:function(t,l,c){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})}function u(){m.css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1000"}).fadeIn("slow");const o=g.val(),a={dept_code,class_code:o,search:O.val(),page:b,rows_per_page:parseInt($("#pagination .rows_per_page").val()??50)};$.ajax({url:"/certificate/card_view",type:"POST",contentType:"application/json",data:JSON.stringify(a),cache:!0,success:function(e){const d=$("#tbl_stu_card_view");d.empty();let r=e.current_page,t=e.page,l=e.data;const c=document.createDocumentFragment();if(l&&l.length>0)l.map((n,s)=>{let i=n.status_print==1?"#2f99d1":"#ddd",_=n.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${n.stu_photo}`;const p=$("<div>").addClass("col-md-4 g-2 mt-2").append($("<div>").addClass("student-card-view").css("border",`2px solid ${i}`).append($("<img>").attr("src",_).attr("alt","Profile Picture").attr("width","150").attr("height","200").attr("name","btn_update_view_info_print").attr("id","btn_update_view_info_print").attr("data-stu_code",n.code).attr("data-dept_code",n.department_code).attr("data-class_code",n.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_update")).append($("<div>").addClass("card-body student-information").append($("<div>").addClass("name").text(`${n.name_2} ${n.name}`)).append($("<div>").addClass("id").text(n.code)).append($("<div>").addClass("phone").text(n.phone_student)).append($("<div>").addClass("info").text(n.dept)).append($("<div>").addClass("info").html(`${n.class==null?"No Class":n.class}
                                                    <label class="${n.class_remaining} fw-bold" title="Expire Card">${n.remaining}</label>`)).append($("<hr>")).append($("<button>").addClass("btn btn-outline-info btn-sm").attr("type","button").attr("name","btn_print_card_view").attr("id","btn_print_card_view").attr("data-print_card_id",n.id).attr("data-stu_code",n.code).attr("data-dept_code",n.department_code).attr("data-class_code",n.class_code).attr("title","Print").attr("data-toggle","modal").attr("data-target","#modal_card_print_card").css({"margin-right":"5px"}).html('<i class="mdi mdi-printer btn-icon-append"></i>')).append($("<button>").attr("type","button").addClass("btn btn-outline-danger btn-sm").attr("title","Print").attr("name","btn_print_card_set_revision_view").attr("id","btn_print_card_set_revision_view").attr("data-print_card_id",n.id).attr("data-stu_code",n.code).attr("data-dept_code",n.department_code).attr("data-class_code",n.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_print_revisino").attr("hidden",n.status_print==0||n.status_print==null).append($("<i>").addClass("mdi mdi-plus btn-icon-append")).css("margin-right","5px")).append($("<button>").attr("type","button").addClass("btn btn-outline-success btn-sm").attr("id","btn_card_view").attr("title","View Detail").attr("data-toggle","modal").attr("data-target","#modal_card_view_detail").attr("data-stu_code",n.code).attr("data-dept_code",n.department_code).css({"margin-right":"5px"}).attr("data-class_code",n.class_code).append($("<i>").addClass("mdi mdi-account-search"))).append($("<button>").attr("type","button").addClass("btn btn-outline-primary btn-sm").attr("title","Update").attr("name","btn_update_view_info_print").attr("id","btn_update_view_info_print").attr("data-stu_code",n.code).attr("data-dept_code",n.department_code).attr("data-class_code",n.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_update").css({"margin-right":"5px"}).append($("<i>").addClass("mdi mdi-border-color"))).append($("<button>").attr("type","button").addClass("btn btn-outline-danger btn-sm").attr("title","Disable Active Print").attr("name","btn_diable_view_info_print").attr("id","btn_diable_view_info_print").attr("data-stu_code",n.code).attr("data-dept_code",n.department_code).attr("data-class_code",n.class_code).attr("data-toggle","modal").attr("data-target","#modal_card_disable_active").css({"margin-right":"5px"}).append($("<i>").addClass("mdi mdi-shuffle-disabled")).prop("hidden",n.status_print!==1)).append($("<button>").attr("type","button").addClass("btn btn-outline-secondary btn-rounded btn-icon pull-right").css({width:"30px",height:"30px","margin-right":"5px"}).append($("<label>").addClass("text-primary").text(s+1+(r-1)*t)))));c.appendChild(p[0])});else{const n=$("<div>").addClass("text-center").append($("<label>").addClass("text-center").text("រកមិនឃើញទិន្ន័យនៅក្នុងប្រព័ន្ធ!"));c.appendChild(n[0])}d.append(c),$("#pagination").html(e.links),setTimeout(function(){m.fadeOut()},50)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})}function f(){m.css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1000"}).fadeIn("slow");const o=g.val(),a={dept_code,class_code:o,search:O.val(),page:y,rows_per_page:parseInt($("#pagination_list .rows_per_page").val()??50)};$.ajax({url:"/certificate/card_view_list",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(e){const d=$("#tbl_card_stu_list");d.empty();let r=e.current_page,t=e.page,l=e.data;const c=document.createDocumentFragment();if(l&&l.length>0)$.each(l,function(n,s){const i=$("<tr>");i.append($("<td>").attr("height","40").text(n+1+(r-1)*t)),i.append($("<td>").text(s.code)),i.append($("<td>").text(s.name_2)),i.append($("<td>").text(s.name)),i.append($("<td>").text(s.gender)),i.append($("<td>").text(s.date_of_birth??"No DOB")),i.append($("<td>").text(s.phone_student)),i.append($("<td>").text(s.class==null?"No Class":s.class)),i.append($("<td>").text(s.skill)),i.append($("<td>").text(s.level));const _=$("<div>").addClass("hover-photo").append($("<img>").attr("src",s.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${s.stu_photo}`).attr("alt","John's Photo"));i.append($("<td>").append(_)),i.append($("<td>").addClass("text-center").text(s.count_revision));const p=$("<div>").addClass("badge badge-pill").addClass(s.status_print==1?"badge-success":"badge-danger").text(s.status_print==1?"Already":"No");i.append($("<td>").append(p));const D=$("<div>").addClass("dropdown").append($("<button>").attr({type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",title:"More Options"}).addClass("btn btn-outline-secondary btn-rounded btn-icon").css({width:"35px",height:"35px","margin-right":"5px"}).append($("<i>").addClass("mdi mdi-dots-vertical"))).append($("<ul>").addClass("dropdown-menu").attr("aria-labelledby","dropdownMenuButton").append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",name:"btn_print_card_view",id:"btn_print_card_view","data-print_card_id":s.id,"data-stu_code":s.code,"data-dept_code":s.department_code,"data-class_code":s.class_code,"data-toggle":"modal","data-target":"#modal_card_print_card"}).append($("<i>").addClass("mdi mdi-printer btn-icon-append")," Print"))).append(s.status_print==0||s.status_print==null?"":$("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",name:"btn_print_card_set_revision_view",id:"btn_print_card_set_revision_view","data-print_card_id":s.id,"data-stu_code":s.code,"data-dept_code":s.department_code,"data-class_code":s.class_code,"data-toggle":"modal","data-target":"#modal_card_print_revisino"}).append($("<i>").addClass("mdi mdi-plus btn-icon-append")," Print"))).append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",title:"View Detail",id:"btn_card_view","data-toggle":"modal","data-target":"#modal_card_view_detail","data-stu_code":s.code,"data-dept_code":s.department_code,"data-class_code":s.class_code}).append($("<i>").addClass("mdi mdi-account-search")," View"))).append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",title:"Update",name:"btn_update_view_info_print",id:"btn_update_view_info_print","data-stu_code":s.code,"data-dept_code":s.department_code,"data-class_code":s.class_code,"data-toggle":"modal","data-target":"#modal_card_update"}).append($("<i>").addClass("mdi mdi-border-color")," Update"))).append($("<li>").append($("<a>").addClass("dropdown-item").attr({href:"javascript:void(0)",title:"Disable Active Print",name:"btn_diable_view_info_print",id:"btn_diable_view_info_print","data-stu_code":s.code,"data-dept_code":s.department_code,"data-class_code":s.class_code,"data-toggle":"modal","data-target":"#modal_card_disable_active"}).append($("<i>").addClass("mdi mdi-shuffle-disabled")," Disable"))));i.append($("<td>").append(D)),c.appendChild(i[0])});else{const n=$("<div>").addClass("text-center").append($("<label>").addClass("text-center").attr("colspan",4).attr("height",40).text("រកមិនឃើញទិន្ន័យនៅក្នុងប្រព័ន្ធ!"));c.appendChild(n[0])}d.append(c),$("#pagination_list").html(e.links),setTimeout(function(){m.fadeOut()},50)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})}function k(){m.css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1000"}).fadeIn("slow");const o=g.val(),a={dept_code,class_code:o};$.ajax({url:"/certificate/card_total_student",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(e){$("#tt_students").html(Number(e.total_students)),$("#tt_students_f").html(e.total_female),$("#tt_students_m").html(e.total_male),$("#total_status_1").html(e.total_status_1),$("#total_female_status_1").html(e.total_female_status_1),$("#total_male_status_1").html(e.total_male_status_1),setTimeout(function(){m.fadeOut()},100)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})}function w(){m.css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)","z-index":"1111"}).fadeIn("slow");const o=$("#txt_due_level").val(),a=$("#txt_due_class").val(),e=$("#tbl_view_expire"),d=$("#tbl_view_expire tbody"),r=e.find("thead th").length,t=document.createDocumentFragment(),l={level_code:o,class_code:a};$.ajax({url:"/certificate/student_card/expire/show",type:"POST",contentType:"application/json",data:JSON.stringify(l),beforeSend:function(){d.empty()},success:function(c){if(c&&c.length>0)$.each(c,function(n,s){let i=s.class,_=s.updated_by;const p=$("<tr>");p.append($("<td>").attr("height","40").text(n+1)),p.append($("<td>").text(i.level)),p.append($("<td>").text(i.name)),p.append($("<td>").text(s.expire_date)),p.append($("<td>").text(s.print_expire_date)),p.append($("<td>").append($("<div>").append($("<button>",{type:"button",class:"btn btn-outline-secondary btn-rounded btn-icon",css:{width:"30px",height:"30px","margin-right":"5px"}}).append($("<label>",{class:"text-primary",html:'<i class="mdi mdi-account-check"></i>'}))).append($("<label>",{class:"text-primary",html:s.created_by.name+":"+s.create_by_date})))),_==null?p.append($("<td>").append($("<label>",{class:"text-primary",html:"---"}))):p.append($("<td>").append($("<div>").append($("<button>",{type:"button",class:"btn btn-outline-secondary btn-rounded btn-icon",css:{width:"30px",height:"30px","margin-right":"5px"}}).append($("<label>",{class:"text-primary",html:'<i class="mdi mdi-account-check"></i>'}))).append($("<label>",{class:"text-primary",html:s.updated_by.name+":"+s.update_by_date})))),t.appendChild(p[0])});else{const n=$("<tr>");n.append($("<td>").attr("height","40").attr("colspan",r).addClass("text-center").append($("<label>").text("រកមិនឃើញទិន្ន័យនៅក្នុងប្រព័ន្ធ!"))),t.appendChild(n[0])}d.append(t),setTimeout(function(){m.fadeOut()},100)},error:function(c,n,s){notyf.error(`Error submitting class code: ${c.statusText||"Unknown error"}`)}})}g.on("change",function(){U(),k(),b=1,u(),y=1,f()});h.on("change",function(){j()});h.attr("disabled",!0);v.on("change",function(){j()});v.attr("disabled",!0);x.on("change",function(){j()});x.attr("disabled",!0);$("#sch_info_student").on("keyup",function(){b=1,u(),y=1,f()});C.on("click",".btn_refresh",function(){b=1,$("#pagination .rows_per_page").val(50),u()});C.on("change",".rows_per_page",function(o){o.preventDefault(),b=1,u()});C.on("click",".page-link[data-page]",function(o){o.preventDefault();var a=$(this).data("page");b=a,u()});S.on("click",".btn_refresh",function(){y=1,$("#pagination_list .rows_per_page").val(50),f()});S.on("change",".rows_per_page",function(o){o.preventDefault(),y=1,f()});S.on("click",".page-link[data-page]",function(o){o.preventDefault();var a=$(this).data("page");y=a,f()});$("body").on("click","#btn_print_card_view",function(o){const a=$(this).data("print_card_id"),e=$(this).data("stu_code"),d=$(this).data("dept_code"),r=$(this).data("class_code");$("#hidden_print_card_id").val(a),$("#hidden_stu_code").val(e),$("#hidden_dept_code").val(d),$("#hidden_class_code").val(r)});$("body").on("click","#btn_print_card",function(o){const a={print_card_id:$("#hidden_print_card_id").val(),stu_code:$("#hidden_stu_code").val(),dept_code:$("#hidden_dept_code").val(),class_code:$("#hidden_class_code").val()};$.ajax({url:"/certificate/print_card",type:"POST",contentType:"application/json",data:JSON.stringify(a),async:!0,success:function(e){jQuery(function(d){const r=d("<div>").html(e);d("body").append(r),r.printThis({importCSS:!1,importStyle:!1,removeInline:!0,base:!1,formValues:!0,iframe:!0,debug:!1}),r.remove()})},complete:function(){},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_print_card_set_revision_view",function(o){const a=$(this).data("print_card_id"),e=$(this).data("stu_code"),d=$(this).data("dept_code"),r=$(this).data("class_code");$("#hidden_revision_print_card_id").val(a),$("#hidden_revision_stu_code").val(e),$("#hidden_revision_dept_code").val(d),$("#hidden_revision_class_code").val(r)});$("body").on("click","#btn_print_set_revision",function(o){const a={print_card_id:$("#hidden_revision_print_card_id").val(),stu_code:$("#hidden_revision_stu_code").val(),dept_code:$("#hidden_revision_dept_code").val(),class_code:$("#hidden_revision_class_code").val()};$.ajax({url:"/certificate/print_card_revision",type:"POST",contentType:"application/json",data:JSON.stringify(a),async:!0,success:function(e){},complete:function(){k(),u(),f()},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_update_view_info_print",function(o){const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code");$("#hidden_update_stu_code").val(a),$("#hidden_update_dept_code").val(e),$("#hidden_update_class_code").val(d);const r={stu_code:a,dept_code:e,class_code:d};$.ajax({url:"/certificate/card_view_info",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){$("#txt_up_view_name").html(t.name),$("#txt_up_view_id").html(t.code),$("#txt_up_view_class").html(t.class),$("#txt_up_view_skill").html(t.skill),$("#txt_up_view_level").html(t.level),$("#txt_up_view_shift").html(t.section_type),$("#txt_up_view_expire_card").html(t.print_expire_date);var l=t.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${t.stu_photo}`;$("#txt_photo_student").attr("src",l)},error:function(t,l,c){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_card_view",function(o){const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code");$("#hidden_update_stu_code").val(a),$("#hidden_update_dept_code").val(e),$("#hidden_update_class_code").val(d);const r={stu_code:a,dept_code:e,class_code:d};$.ajax({url:"/certificate/card_view_info",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(t){$("#txt_view_name").html(t.name),$("#txt_view_id").html(t.code),$("#txt_view_class").html(t.class),$("#txt_view_skill").html(t.skill),$("#txt_view_level").html(t.level),$("#txt_view_shift").html(t.section_type),$("#txt_view_expire_card").html(t.print_expire_date),$("#txt_view_fullname_kh").html(t.name_2),$("#txt_view_fullname_eng").html(t.name),$("#txt_view_dob").html(t.date_of_birth),$("#txt_view_class_1").html(t.class),$("#txt_view_phone").html(t.phone_student),$("#txt_view_skill_1").html(t.skill),$("#txt_view_email").html(t.email),$("#txt_view_gender").html(t.gender),$("#txt_view_addr").html(t.student_address),$("#txt_view_dept").html(t.dept),$("#txt_view_father").html(t.father_name),$("#txt_view_father_phone").html(t.father_phone),$("#txt_view_father_job").html(t.father_occupation),$("#txt_view_mother").html(t.mother_name),$("#txt_view_mother_phone").html(t.mother_phone),$("#txt_view_mother_job").html(t.mother_occupation),$("#txt_guardian_name").html(t.guardian_name),$("#txt_guardian_phone").html(t.guardian_phone),$("#txt_guardian_occupation").html(t.guardian_occupation),$("#txt_guardian_address").html(t.guardian_address);var l=t.photo_status==!1?"/asset/NTTI/images/faces/default_User.jpg":`/uploads/student/${t.stu_photo}`;$("#txt_view_photo").attr("src",l)},error:function(t,l,c){notyf.error(`Error submitting class code: ${t.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_update_info",function(o){let a=new FormData;a.append("stu_code",$("#hidden_update_stu_code").val()),a.append("dept_code",$("#hidden_update_dept_code").val()),a.append("class_code",$("#hidden_update_class_code").val());var e=$("#fileUploadProfileStu")[0].files[0];e?a.append("photo",e):a.append("photo",null),$.ajax({url:"/certificate/upload_student_info",type:"POST",processData:!1,contentType:!1,cache:!0,async:!0,data:a,success:function(d){d.success==!0?($("#fileUploadProfileStu").val(""),u(),f(),notyf.success(d.message)):notyf.error(d.errors.photo[0])},error:function(d,r,t){notyf.error(`Error submitting class code: ${d.error||"Unknown error"}`)}})});$("#fileUploadProfileStu").on("change",function(){const o=this.files[0];if(o){const a=new FileReader;a.onload=function(e){$(".profile-image img").attr("src",e.target.result)},a.readAsDataURL(o)}});$("body").on("click","#btn_diable_view_info_print",function(o){const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code");$("#hidden_disable_stu_code").val(a),$("#hidden_disable_dept_code").val(e),$("#hidden_diable_class_code").val(d)});$("body").on("click","#btn_card_disable_active",function(o){const a={stu_code:$("#hidden_disable_stu_code").val(),dept_code:$("#hidden_disable_dept_code").val(),class_code:$("#hidden_diable_class_code").val()};$.ajax({url:"/certificate/disable_student_info",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(e){e.success==!0?(k(),u(),f(),notyf.success(e.message)):notyf.error(e.message)},error:function(e,d,r){notyf.error(`Error submitting class code: ${e.statusText||"Unknown error"}`)}})});P.on("change",function(){const o={date:$(this).val()};$.ajax({url:"/certificate/show_change_date_print_card",type:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(a){$("#txt_up_khmer_lunar").val(a.date_lunar),$("#txt_up_date_create").val(`រាជធានីភ្នំពេញ, ${a.date_khmer}`)},error:function(a,e,d){notyf.error(`Error submitting class code: ${a.statusText||"Unknown error"}`)}})});$("#sl_due_expire_date").on("change",function(){const o={date:$(this).val()};$.ajax({url:"/certificate/show_change_date_print_card",type:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(a){$("#txt_due_expire_date").val(a.date_lunar)},error:function(a,e,d){notyf.error(`Error submitting class code: ${a.statusText||"Unknown error"}`)}})});$("body").on("click","#btn_upload_zip_photo",function(o){let a=$("#up_type_option").val(),e=new FormData;var d=$("#zipFile")[0].files[0];if(e.append("type",a),e.append("zipFile",d),e.append("dept_code",dept_code),$("#previewContainer img").each(function(){let r=$(this).attr("src"),t=$(this).attr("data-name");e.append("imageSources[]",r),e.append("fileNames[]",t)}),!a)return notyf.error("សូមជ្រើសរើសប្រភេទ File Upload"),!1;$.ajax({url:"/certificate/upload_zip_photo",type:"POST",processData:!1,contentType:!1,cache:!1,async:!1,data:e,success:function(r){r.status==200?($("#fm_up_card_base_option")[0].reset(),$("#modal_card_upload_zip_photo .btn-close").trigger("click"),notyf.success(r.message),u()):notyf.error(r.message)},error:function(r,t,l){notyf.error(`Error submitting class code: ${r.error||"Unknown error"}`)}})});$("body").on("click","#btn_card_upload_multiple",function(o){let a=[];$("#previewContainer img").each(function(){let d=$(this).attr("src");if(d.startsWith("data:image")){let t=($(this).attr("alt")||"unnamed").split(".").slice(0,-1).join(".");a.push({name:t,src:d})}});const e={images:a};$.ajax({url:"/certificate/upload_multiple_photo",type:"POST",contentType:"application/json",data:JSON.stringify(e),success:function(d){},error:function(d,r,t){notyf.error(`Error submitting class code: ${d.statusText||"Unknown error"}`)}})});$("body").on("change","#up_type_option",function(o){var a=$(this).val();a=="zip"?($("#up_zip").removeAttr("hidden"),$("#up_multiple").attr("hidden",!0)):a=="multiple"&&($("#up_multiple").removeAttr("hidden"),$("#up_zip").attr("hidden",!0))});$("body").on("click","#btn_print_card_pdf",function(o){o.preventDefault();const a=$(this).data("stu_code"),e=$(this).data("dept_code"),d=$(this).data("class_code"),r=`/certificate/print_card_pdf?stu_code=${a}&dept_code=${e}&class_code=${d}`;window.open(r,"_blank")});$("#txt_due_date").on("change",function(){const o={date:$(this).val()};$.ajax({url:"/certificate/show_change_date_print_card",type:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(a){$("#txt_due_khmer_lunar").val(a.date_lunar),$("#txt_due_date_create").val(`រាជធានីភ្នំពេញ, ${a.date_khmer}`)},error:function(a,e,d){notyf.error(`Error submitting class code: ${a.statusText||"Unknown error"}`)}})});$("#modal_card_due_date").on("click","#btn_due_date_this_session",function(o){let a=$("#txt_due_khmer_lunar").val(),e=$("#txt_due_date_create").val(),d=$("#txt_due_expire_date").val();const r={session_code:$("#session_code").val(),print_date:$("#txt_due_date").val(),print_khmer_lunar:a,print_date_due:e,print_expire_date:d};let t=!0;if(["#txt_due_khmer_lunar","#txt_due_date_create"].forEach(function(c){let n=$(c);$.trim(n.val())===""?(n.css("border","2px solid red"),t=!1):n.css("border","")}),!t)return!1;$.ajax({url:"/certificate/card_due_date",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(c){c.status==200?(notyf.success(c.message),$("#fm_card_due_date")[0].reset(),$("#modal_card_due_date .btn-close").trigger("click")):notyf.error(c.message)},error:function(c,n,s){notyf.error(`Error submitting class code: ${c.statusText||"Unknown error"}`)}})});$("#modal_card_due_date").on("click","#btn_update_date_this_session",function(o){let a=$("#txt_due_khmer_lunar").val(),e=$("#txt_due_date_create").val(),d=$("#txt_due_expire_date").val();const r={session_code:$("#session_code").val(),print_date:$("#txt_due_date").val(),print_khmer_lunar:a,print_date_due:e,print_expire_date:d};let t=!0;if(["#txt_due_khmer_lunar","#txt_due_date_create"].forEach(function(c){let n=$(c);$.trim(n.val())===""?(n.css("border","2px solid red"),t=!1):n.css("border","")}),!t)return!1;$.ajax({url:"/certificate/card_due_date_update",type:"POST",contentType:"application/json",data:JSON.stringify(r),success:function(c){c.status==200?(notyf.success(c.message),$("#fm_card_due_date")[0].reset(),$("#modal_card_due_date .btn-close").trigger("click")):notyf.error(c.message)},error:function(c,n,s){notyf.error(`Error submitting class code: ${c.statusText||"Unknown error"}`)}})});$("#modal_card_create_expire_date").on("click","#btn_due_expire_card",function(o){let a=$("#txt_due_level").val(),e=$("#txt_due_class").val(),d=$("#sl_due_expire_date").val(),r=$("#txt_due_expire_date").val();const t={session_code:$("#session_code").val(),level:a,class_code:e,expire_date:d,print_expire_date:r};let l=!0;if(["#txt_due_level","#txt_due_class","#sl_due_expire_date","#txt_due_expire_date"].forEach(function(s){let i=$(s);$.trim(i.val())===""?(i.css("border","2px solid red"),l=!1):i.css("border","")}),["#txt_due_level","#txt_due_class"].forEach(function(s){let i=$(s),_=i.next(".select2-container");$.trim(i.val())===""?(_.find(".select2-selection").css("border","2px solid red"),l=!1):_.find(".select2-selection").css("border","")}),!l)return!1;$.ajax({url:"/certificate/card_due_expire",type:"POST",contentType:"application/json",data:JSON.stringify(t),success:function(s){s.status==200?(notyf.success(s.message),w(),u(),f()):notyf.error(s.message)},error:function(s,i,_){notyf.error(`Error submitting class code: ${s.statusText||"Unknown error"}`)}})});$("#modal_card_create_expire_date").on("click","#btn_due_update_expire_card",function(o){let a=$("#txt_due_level").val(),e=$("#txt_due_class").val(),d=$("#sl_due_expire_date").val(),r=$("#txt_due_expire_date").val();const t={session_code:$("#session_code").val(),level:a,class_code:e,expire_date:d,print_expire_date:r};let l=!0;if(["#txt_due_level","#txt_due_class","#sl_due_expire_date","#txt_due_expire_date"].forEach(function(s){let i=$(s);$.trim(i.val())===""?(i.css("border","2px solid red"),l=!1):i.css("border","")}),["#txt_due_level","#txt_due_class"].forEach(function(s){let i=$(s),_=i.next(".select2-container");$.trim(i.val())===""?(_.find(".select2-selection").css("border","2px solid red"),l=!1):_.find(".select2-selection").css("border","")}),!l)return!1;$.ajax({url:"/certificate/card_due_expire_update",type:"PUT",contentType:"application/json",data:JSON.stringify(t),success:function(s){s.status==200?(notyf.success(s.message),w(),u(),f()):notyf.error(s.message)},error:function(s,i,_){notyf.error(`Error submitting class code: ${s.statusText||"Unknown error"}`)}})});$("#modal_card_create_expire_date").on("change","#txt_due_level",function(o){const e={level:$(this).val()};$.ajax({url:"/certificate/card_expire_show_level",type:"POST",contentType:"application/json",data:JSON.stringify(e),beforeSend:function(){$("#txt_due_class").empty()},success:function(d){d.record_level;let r=new Date(d.record_date).toISOString().split("T")[0];$("#sl_due_expire_date").val(r),$("#txt_due_expire_date").val(d.record_exp_year),$("#txt_due_class").append(new Option("Select All","code_all",!0,!1)),$.map(d.record_level,function(t){$("#txt_due_class").append(new Option(t.name,t.code,!1,!1))}),T("#txt_due_class","#modal_card_create_expire_date"),w()},error:function(d,r,t){notyf.error(`Error submitting class code: ${d.statusText||"Unknown error"}`)}})});$("#modal_card_create_expire_date").on("change","#txt_due_class",function(o){w()});$("body").on("click","#btn_open_expire_date",function(o){w()});k();u();f();
